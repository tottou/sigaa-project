<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>

	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<meta http-equiv="pragma" content="no-cache" />
	<meta http-equiv="cache-control" content="no-cache,no-store,max-age=0" />


</h:head>
<h:body>

	<p:panel header="Tarefas">
		<p:dataGrid var="agenda" value="#{actionCard.listaAgendaCard}" columns="2" emptyMessage="Não há tarefas agendadas para este aluno.">
			<p:column>
			<p:panel header="#{agenda.nome}" >
				<h:panelGrid columns="2">		
						<h:outputText value="Sessão atual: " style="font-weight:bold;"></h:outputText>
					<h:outputText value="#{agenda.remaining}" rendered="#{agenda.remaining!=agenda.sessoes+1}"></h:outputText>
					<h:outputText value="Sessões finalizadas" rendered="#{agenda.remaining==agenda.sessoes+1}"></h:outputText>
					<h:outputText value="Total de sessões: "  style="font-weight:bold;"></h:outputText>
					<h:outputText value="#{agenda.sessoes}"></h:outputText>
			
					</h:panelGrid>
					
			
			<table align="center" cellspacing="5" >
			<tr valign="middle" align="center" >
			<ui:repeat var="tarefa" value="#{agenda.tarefas}" varStatus="status" >
			
				<td>
						<p:panel>
							<h:graphicImage value="#{tarefa.imagem}" height="40" width="40"
								alt="Imagem tarefa" cache="false"></h:graphicImage><br/>
								<h:outputText value="#{tarefa.nome}"></h:outputText>
							
						
					</p:panel>
						</td>
						
		
			
						</ui:repeat>
						</tr>
						</table>
						
						<p:separator id="customSeparatodr"  />   
					<table align="center" cellspacing="5" >
					<tr valign="middle" align="center" >
					<td>
					<p:commandButton value="Histórico" styleClass="botao" action="#{actionCard.gerarTarefaRelatorio(agenda.id)}" update=":formC:pnlCorpo" 
							actionListener="#{controladora.historicoTarefa}" icon="ui-icon-clock"></p:commandButton>
					</td><td>
					<p:commandButton value="Iniciar tarefa" styleClass="botao" icon="ui-icon-clipboard" action="#{actionCard.iniciarTarefa(agenda.id)}" rendered="#{agenda.remaining!=agenda.sessoes+1}"
					 onsuccess="window.open('/SiGAA/acionatarefa.jsf');" actionListener="#{controladora.card}" update=":formC:pnlCorpo" ></p:commandButton>	
						<p:commandButton value="Tarefa finalizada" styleClass="botao" icon="ui-icon-clipboard" rendered="#{agenda.remaining==agenda.sessoes+1}"
					 onclick="donez1.show()"></p:commandButton>	
					
					</td>				
					</tr>
					</table>
					
					</p:panel>
		</p:column>
		
		</p:dataGrid>
		
				<br/><br/>
				
				<p:dialog widgetVar="donez1">
				Todas sessões para esta tarefa já foram realizadas.
				</p:dialog>
		

	<p:commandButton value="Voltar" update=":formC:pnlCorpo"
							icon="ui-icon-arrowrefresh-1-e"  actionListener="#{controladora.card}"/> 

</p:panel>


</h:body>
</html>